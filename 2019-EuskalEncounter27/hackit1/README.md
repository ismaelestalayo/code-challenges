# HACK IT 1

## Work In Progess

Clasico primer nivel del hackit de la euskal. Como suele ser usual, tenemos que ir al código de la página, y dentro del HTML veremos un tag `<script>` con un código sospechoso. Lo copiamos y lo pasamos por el primer _embellecedor_ de JavaScript favorito. Esto nos devolverá el siguiente script:

```javascript
function q(e) {
    var a = ">,------------------------------------------------------------------------------------[<+>[-]],----------------------------------------------------[<+>[-]],------------------------------------------------------------------------------------------------------------------[<+>[-]],----------------------------------------------------------------------------------------------------------------[<+>[-]],-------------------------------------------------[<+>[-]],--------------------------------------------------------------------------------------------------------------------[<+>[-]],-----------------------------------------------------------------------------------[<+>[-]],-------------------------------------------------------------------[<+>[-]],------------------------------------------------------------------------------------------------------------------[<+>[-]],-------------------------------------------------[<+>[-]],----------------------------------------------------------------------------------------------------------------[<+>[-]],------------------------------------------------------------------------------------[<+>[-]],[<+>[-]][-]+<[>>>++[>+++[>+++++++++++++++++++<-]<-]>>.-------------.-.<<<<[-]<[-]]>[>>>++[>+++[>+++++++++++++++++<-]<-]>>+.[>+>+<<-]>+++++++++++.>--..<----.<<<[-]]";
    let r = 0,
        f = 0;
    var i = a.length,
        c = new Uint8Array(3e4),
        s = "",
        b = 10240,
        k = 0;
	for (r = 0; r < i && !(b < 0); r++) 
        switch (b--, a[r]) {
            case ">":
                f++;
                break;
            case "<":
                f > 0 && f--;
                break;
            case "+":
                c[f] = c[f] + 1 & 255;
                break;
            case "-":
                c[f] = c[f] - 1 & 255;
                break;
            case ".":
                s += String.fromCharCode(c[f]);
                break;
            case ",":
                k >= e.length ? c[f] = 0 : c[f] = e.charCodeAt(k), k++;
                break;
            case "[":
                if (!c[f])
                    for (var t = 0; a[++r];)
                        if ("[" === a[r]) t++;
                        else if ("]" === a[r]) {
                    if (!(t > 0)) break;
                    t--
                    }
                break;
            case "]":
                if (c[f])
                    for (t = 0; a[--r];)
                        if ("]" === a[r]) t++;
                        else if ("[" === a[r]) {
                            if (!(t > 0)) break;
                            t--
                        }
	}
    return s
}
```

La clave de todo este hackit está claramente en el `string` a del principio, ya que los caracteres de este son los que mandan que operaciones realizar sobre la contraseña que introduzcamos. Si nos centramos únicamente en dicho string podemos ver cierto patrón que resulta en 13 lineas (lo que probablemente se traduzca en una contraseña de 13 caracteres):

```
>,------------------------------------------------------------------------------------[<+>[-]]
,----------------------------------------------------[<+>[-]]
,------------------------------------------------------------------------------------------------------------------[<+>[-]]
,----------------------------------------------------------------------------------------------------------------[<+>[-]]
,-------------------------------------------------[<+>[-]]
,--------------------------------------------------------------------------------------------------------------------[<+>[-]]
,-----------------------------------------------------------------------------------[<+>[-]]
,-------------------------------------------------------------------[<+>[-]]
,------------------------------------------------------------------------------------------------------------------[<+>[-]]
,-------------------------------------------------[<+>[-]]
,----------------------------------------------------------------------------------------------------------------[<+>[-]]
,------------------------------------------------------------------------------------[<+>[-]]
,[<+>[-]][-]+<[>>>++[>+++[>+++++++++++++++++++<-]<-]>>.-------------.-.<<<<[-]<[-]]>[>>>++[>+++[>+++++++++++++++++<-]<-]>>+.[>+>+<<-]>+++++++++++.>--..<----.<<<[-]];
```

Podemos ver como sin duda los `-` tienen pinta de ser la clave de este primer hack it, ya que son el carácter principal de las 13 lineas. Si nos fijamos en la operación que realiza el `switch` con dicho caracter, podemos ver que decrementa el valor de un caracter del array c, y después realiza el módulo de dicho resultado con 255 para que el resultado siempre esté entre 0 y 255. Pero hay un problema, el array c tiene un tamaño de 30000

Para conseguir la contraseña solo necesitamos pasar esos valores por un conversor ASCII a texto, y tenemos nuestro primer nivel!

```
84 52 114 112 49 116 83 67 114 49 112 84 --> T4rp1tSCr1pT
```